<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
        {% block title %}
            编程一小时
        {% endblock %}
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="在线一对一少儿编程"/>
    <link rel="shortcut icon" href="/static/img/kuding.ico">
    <!--font awesome图标引用地址-->
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- Animate.css -->
    <link rel="stylesheet" href="/static/css/animate.css">
    <!-- Icomoon Icon Fonts-->
    <link rel="stylesheet" href="/static/css/icomoon.css">
    <!-- Bootstrap  -->
    <link rel="stylesheet" href="/static/plug/bootstrap/css/bootstrap.css">

    <!-- Magnific Popup -->
    <link rel="stylesheet" href="/static/css/magnific-popup.css">

    <!-- Owl Carousel  -->
    <link rel="stylesheet" href="/static/css/owl.carousel.min.css">
    <link rel="stylesheet" href="/static/css/owl.theme.default.min.css">

    <!-- Theme style  -->
    <link rel="stylesheet" href="/static/css/z_style.css">
    <link rel="stylesheet" href="/static/css/qt_style.css">

    <!-- Modernizr JS -->
    <script src="/static/js/modernizr-2.6.2.min.js"></script>
    <script src="/static/js/respond.min.js"></script>
    <style type="text/css">
        .footer-section {
            margin-top: 0px;
        }
    </style>

    <style type="text/css">

        html {
            -webkit-text-size-adjust: none;
        }

        @font-face {
            font-family: "草书";
            src: url("/static/ttf/caoshu.TTF");
        }

        @font-face {
            font-family: "小奶泡";
            src: url("/static/ttf/xiaonaibao.ttf");
        }

        @font-face {
            font-family: "腾祥婀娜体简";
            src: url("/static/ttf/TTENuoJ_0.ttf");
        }

        @font-face {
            font-family: "哈哈呼嘿字";
            src: url("/static/ttf/heiheihuahu.ttf");
        }

        @font-face {
            font-family: "甜蜜小女生";
            src: url("/static/ttf/tianmi.ttf");
        }

        @font-face {
            font-family: "桃心悦圆";
            src: url("/static/ttf/taoxin.ttf");
        }

        @font-face {
            font-family: "小雨滴";
            src: url("/static/ttf/xioayudi.ttf");
        }

        @font-face {
            font-family: "可爱萌宠体";
            src: url("/static/ttf/keai.ttf");
        }

        @font-face {
            font-family: "腾祥泡泡体繁";
            src: url("/static/ttf/Tensentype-PaoPaoF.ttf");
        }

        @font-face {
            font-family: "爱心小兔";
            src: url("/static/ttf/xiaotu.ttf");
        }

        @font-face {
            font-family: "浪花";
            src: url("/static/ttf/langhua.otf");
        }
    </style>

    <style type="text/css">img {
        border: 0;
    }

    li {
        list-style: none;
    }

    .user_callback #user_pic {
        position: relative;
        overflow: hidden;
        height: 500px;
        width: 1200px;
        z-index: 2;
        margin: 0 auto;
    }

    .user_callback #user_pic ul {
        width: 990px;
        height: 285px;
        position: relative;
        top: 80px;
        left: 105px;
    }

    .user_callback #user_pic ul li {
        position: absolute;
    }

    .user_callback #user_pic ul img {
        position: relative;
        top: 0;
        left: 0;
    }

    .user_callback #user_pic ul .user_pic1 {
        top: -285px;
        left: -231px;
        z-index: 0;
    }

    .user_callback #user_pic ul .user_pic2 {
        top: -23px;
        left: -99.5px;
        z-index: 2;
    }

    .user_callback #user_pic ul .user_pic3 {
        top: 66px;
        left: 68px;
        z-index: 3;
    }

    .user_callback #user_pic ul .user_pic4 {
        top: 110px;
        left: 247.5px;
        z-index: 4;
    }

    .user_callback #user_pic ul .user_pic5 {
        top: 110px;
        left: 495px;
        z-index: 3;
    }

    .user_callback #user_pic ul .user_pic6 {
        top: 66px;
        left: 695.5px;
        z-index: 2;
    }

    .user_callback #user_pic ul .user_pic7 {
        top: -23px;
        left: 852px;
        z-index: 1;
    }

    .user_callback #user_pic ul .user_pic8 {
        top: -285px;
        left: 1000px;
        z-index: 0;
    }

    .user_callback #user_pic ul .user_pic1 a {
        width: 216.5px;
        height: 248px;
    }

    .user_callback #user_pic ul .user_pic2 a {
        width: 225.5px;
        height: 259px;
    }

    .user_callback #user_pic ul .user_pic3 a {
        width: 247.5px;
        height: 285px;
    }

    .user_callback #user_pic ul .user_pic4 a {
        width: 247.5px;
        height: 285px;
    }

    .user_callback #user_pic ul .user_pic5 a {
        width: 247.5px;
        height: 285px;
    }

    .user_callback #user_pic ul .user_pic6 a {
        width: 247.5px;
        height: 285px;
    }

    .user_callback #user_pic ul .user_pic7 a {
        width: 225.5px;
        height: 259px;
    }

    .user_callback #user_pic ul .user_pic8 a {
        width: 216.5px;
        height: 248px;
    }

    .user_callback #user_pic ul li:hover {
        background: #d9bb83;
    }

    .user_callback #user_pic ul li.user_pic1 {
        opacity: 0.2;
        filter: alpha(opacity:20);
    }

    .user_callback #user_pic ul li.user_pic2 {
        opacity: 0.6;
        filter: alpha(opacity:60);
    }

    .user_callback #user_pic ul li.user_pic3 {
        opacity: 0.8;
        filter: alpha(opacity:80);
    }

    .user_callback #user_pic ul li.user_pic4 {
        opacity: 1;
        filter: alpha(opacity:100);
    }

    .user_callback #user_pic ul li.user_pic5 {
        opacity: 1;
        filter: alpha(opacity:100);
    }

    .user_callback #user_pic ul li.user_pic6 {
        opacity: 0.8;
        filter: alpha(opacity:80);
    }

    .user_callback #user_pic ul li.user_pic7 {
        opacity: 0.6;
        filter: alpha(opacity:60);
    }

    .user_callback #user_pic ul li.user_pic8 {
        opacity: 0.2;
        filter: alpha(opacity:20);
    }

    .user_callback #user_pic ul li.user_pic1 img {
        width: 216.5px;
        height: 248px;
    }

    .user_callback #user_pic ul li.user_pic2 img {
        width: 225.5px;
        height: 259px;
    }

    .user_callback #user_pic ul li.user_pic3 img {
        width: 230.5px;
        height: 264px;
    }

    .user_callback #user_pic ul li.user_pic4 img {
        width: 247.5px;
        height: 285px;
    }

    .user_callback #user_pic ul li.user_pic5 img {
        width: 247.5px;
        height: 285px;
    }

    .user_callback #user_pic ul li.user_pic6 img {
        width: 230.5px;
        height: 264px;
    }

    .user_callback #user_pic ul li.user_pic7 img {
        width: 225.5px;
        height: 259px;
    }

    .user_callback #user_pic ul li.user_pic8 img {
        width: 216.5px;
        height: 248px;
    }

    .user_callback #user_pic span {
        display: inline-block;
        *display: inline;
        *zoom: 1;
        width: 80px;
        height: 80px;
        position: absolute;
        top: 160px;
        z-index: 30;
        cursor: pointer;
        opacity: 0.7;
        filter: alpha(opacity=70);
    }

    .user_callback #user_pic:hover span {
        opacity: 1;
        filter: alpha(opacity=100);
    }

    .user_callback #user_pic span img {
        width: 80px;
        height: 80px;
        display: block;
    }

    .user_callback #user_pic span.prev {
        background: url(img/5836af12Neb8a5654.png) no-repeat;
        position: absolute;
        top: 100px;
        left: 5px;
        display: inline-block;
        width: 60px;
        height: 60px;
    }

    .user_callback #user_pic span.next {
        background: url(img/5836af12N536e472b.jpg) no-repeat;
        position: absolute;
        top: 100px;
        right: 5px;
        display: inline-block;
        width: 60px;
        height: 60px;
    }

    .user_callback #user_pic span.prev:hover {
        background: url(img/5836af12Neb8a56523.png) no-repeat;
    }

    .user_callback #user_pic span.next:hover {
        background: url(img/5836b011N9a4d4531.jpg) no-repeat;
    }

    .user_callback {
        background: lightskyblue;
        overflow: hidden;
    }

    .has-error {
        color: red;
    }
    </style>


    <link rel="preload" href="/static/ttf/caoshu.TTF" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/static/ttf/tianmi.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/static/ttf/TTENuoJ_0.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/static/ttf/xiaonaibao.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/static/ttf/xiaotu.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/static/ttf/xioayudi.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/static/ttf/langhua.otf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/static/ttf/taoxin.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/static/ttf/Tensentype-PaoPaoF.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/static/ttf/STHeiti-Light.ttc" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/static/ttf/keai.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/static/ttf/heiheihuahu.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="stylesheet" href="/static/css/amazeui.min.css">
</head>
<body>

<div id="page">
    <nav class="fh5co-nav" role="navigation">

        <div class="user_callback">

            <div class="col-xs-2 left">
                <div id="fh5co-logo">
                    <a href="/index/"><img src="/static/img/logo.png" alt="logo"
                                           style="width: 180px;margin-left: 50px;margin-top: 95px;color: black"></a>
                </div>
                <p>
                <h1 style="width:200px;margin-top: 4em;font-size: 40px;margin-left: 65px;color: black">编程一小时</h1>
                </p>

            </div>


            <div class="user_pic" id="user_pic">
                <span class="prev"></span> <span class="next"></span>
                <ul id="user_call">
                    <li class="user_pic1">
                        <a href="#"> <img src="/static/img/signed_img/1.png" alt="1" width="248" height="285"/></a>
                    </li>
                    <li class="user_pic2">
                        <a href="#"> <img src="/static/img/signed_img/2.png" alt="1" width="248" height="285"/></a>
                    </li>
                    <li class="user_pic3">
                        <a href="#"> <img src="/static/img/signed_img/3.png" alt="1" width="248" height="285"/></a>
                    </li>
                    <li class="user_pic4">
                        <a href="#"> <img src="/static/img/signed_img/4.png" alt="1" width="248" height="285"/></a>
                    </li>
                    <li class="user_pic5">
                        <a href="#"> <img src="/static/img/signed_img/5.png" alt="1" width="248" height="285"/></a>
                    </li>
                    <li class="user_pic6">
                        <a href="#"> <img src="/static/img/signed_img/6.png" alt="1" width="248" height="285"/></a>
                    </li>
                    <li class="user_pic7">
                        <a href="#"> <img src="/static/img/signed_img/7.png" alt="1" width="248" height="285"/></a>
                    </li>
                    <li class="user_pic8">
                        <a href="#"> <img src="/static/img/signed_img/8.png" alt="1" width="248" height="285"/></a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>


    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="myModalLabel">查看证书</h4>
                </div>
                <div class="modal-body">
                    <img na="cer_img" src="" alt="" style="width: 500px;height: 600px">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>


    <div class="am-modal am-modal-no-btn" tabindex="-1" id="doc-modal-1">
        <div class="am-modal-dialog">
            <div class="am-modal-hd" style="font-weight: bolder;padding-bottom: 20px;">确认生成证书，请填写下列内容：
                <a href="javascript: void(0)" class="am-close am-close-spin" data-am-modal-close>&times;</a>
            </div>
            <div class="am-modal-bd">
                <form class="am-form am-form-horizontal" id="signed" action="">
                    {% csrf_token %}
                    <div class="am-form-group">
                        <label for="doc-ipt-3" class="am-u-sm-2 am-form-label">手机号</label>
                        <div class="am-u-sm-10">
                            <input type="text" name="phone" id="phone" placeholder="输入您的手机号">
                            <span style="color: red;margin-right: 220px;"></span>
                        </div>
                    </div>

                    <div class="am-form-group">
                        <label for="doc-ipt-pwd-2" class="am-u-sm-2 am-form-label">单位</label>
                        <div class="am-u-sm-10">
                            <input type="text" name="apartment" id="apartment" placeholder="输入您的单位或者学校名称">
                            <span style="color: red;margin-right: 220px;"></span>
                        </div>
                    </div>

                    <div class="am-form-group">
                        <label for="doc-ipt-pwd-2" class="am-u-sm-2 am-form-label">QQ号</label>
                        <div class="am-u-sm-10">
                            <input type="text" name="QQ" id="QQ" placeholder="输入您的QQ号">
                            <span style="color: red;margin-right: 220px;"></span>
                        </div>
                    </div>

                    <div class="am-form-group">
                        <label for="doc-ipt-pwd-2" class="am-u-sm-2 am-form-label">微信号</label>
                        <div class="am-u-sm-10">
                            <input type="text" name="WX" id="WX" placeholder="输入您的微信号">
                            <span style="color: red;margin-right: 220px;"></span>
                        </div>
                    </div>

                    <div style="margin-top: 40px">
                        <input type="button" class="btn btn-info"
                               style="width: 110px;height: 45px;color: black;border-radius: 0%" id="sub_certificate"
                               value="提交"/>
                        <input type="button" class="btn btn-warning"
                               style="width: 110px;height: 45px;color: black;border-radius: 0%" data-am-modal-close
                               value="取消"/>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <div id="fh5co-contact" style="padding-top: 33em">
        <div class="container">
            <div class="panel panel-default">
                <div class="panel-heading" id="my_sign_head">
                    预览部分
                </div>


                <div class="panel-body text-center" id="my_certificate">

                    <canvas id="myCanvas" style="width:300px;height:200px;">

                    </canvas>
                </div>
            </div>
            <br>
            <div class="panel panel-default">
                <div class="panel-heading">
                    控制台
                </div>
                <form id="form" name="form" method="post">
                    <div class="panel-body row">
                        <div class="form-group col-xs-12 col-sm-12 col-md-12 col-lg-12">
                            <textarea name="text" id="text" class="form-control" row="5"
                                      placeholder="输入文字后，选择字体，点击生成！"></textarea>
                        </div>
                        <div class="form-group col-xs-12 col-sm-6 col-md-3 col-lg-3">
                            <label for="ziti">选择字体：</label>
                            <select name="ziti" id="ziti" class="form-control">
                                <option value="1">草书</option>
                                <option value="2">小奶泡</option>
                                <option value="3">腾祥婀娜体简</option>
                                <option value="4">桃心悦圆</option>
                                <option value="5">小雨滴</option>
                                <option value="6">可爱萌宠体</option>
                                <option value="8">浪花</option>
                                <option value="9">爱心小兔</option>
                                <option value="10">腾祥泡泡体繁</option>
                            </select>
                        </div>

                        <div class="form-group col-xs-12 col-sm-12 col-md-2 col-lg-2">
                            <label>生成签名按钮：</label>
                            <button type="button" id="sub_name" class="btn btn-primary submit form-control"
                                    style="border-radius: 0%;background: lightcoral;color: white;">点击生成签名
                            </button>
                        </div>

                        <div class="form-group col-xs-12 col-sm-12 col-md-2 col-lg-2">
                            <label>生成证书按钮：</label>
                            <button type="button" class="btn btn-primary submit form-control"
                                    data-am-modal="{target: '#doc-modal-1', closeViaDimmer: 0, width: 600, height: 480}"
                                    style="border-radius: 0%;background: lightcoral;color: white;">点击生成证书
                            </button>
                        </div>


                        <div class="form-group col-xs-12 col-sm-12 col-md-2 col-lg-2">
                            <label>查看证书：</label>
                            <button type="button" id="view_certificate" class="btn btn-primary submit form-control"
                                    style="border-radius: 0%;background: lightcoral;color: white;">点击查看证书
                            </button>
                        </div>

                        <div class="form-group col-xs-12 col-sm-12 col-md-2 col-lg-2">
                            <label>下载证书：</label>
                            <a herf="#" type="button" id="down_certificate" class="btn btn-primary submit form-control"
                               style="border-radius: 0%;background: lightcoral;color: white;"
                               download="certificate.jpg">点击下载证书
                            </a>
                        </div>

                        <input type="hidden" name="if_demo" id="if_demo_value" value="show">

                    </div>
                </form>
            </div>
            <br>
            <div class="panel panel-default demoListBox">
                <div class="panel-heading">
                    证书合集
                </div>
                <div class="panel-body">

                    <div class="row demolist">
                        {% for certificate in certificate_list %}
                            <div class="col-xs-12 col-sm-4 col-md-4 col-lg-3">
                                <div class="thumbnail text-center">
                                    <img src={{ certificate.c_cer_url }} data-toggle="tooltip" data-placement="top"
                                         title=""
                                         data-original-title="">
                                    <div class="caption">
                                        <p class="text-center">
                                            <button class="btn btn-primary" data-toggle="modal" data-target="#myModal"
                                                    role="button" onclick="showSignImg('{{ certificate.c_cer_url }}')">
                                                查看
                                            </button>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
                <div class="text-center hidden" style="margin-bottom: 25px">
                    <a href="/sign_list/" class="btn btn-primary" role="button" target="_blank">查看所有签名</a>
                </div>
            </div>
        </div>
    </div>


    <!--这里是kuding信息公司的声明部分-->
    <div class="footer-section">
        <div class="container">
            <div class="footer-grids">
                <div class="col-md-5 footer-grid wow fadeInDownBig animated animated" data-wow-delay=".5s"
                     style="visibility: visible; animation-delay: 0.5s; animation-name: fadeInDownBig;">
                    <h4>公司产品</h4>
                    <p>Noip课程</p>
                    <p>Python课程</p>
                    <p>Java课程</p>
                    <p>Scratch课程</p>
                </div>
                <div class="col-md-4 footer-grid wow fadeInRight animated animated" data-wow-delay=".5s"
                     style="visibility: visible; animation-delay: 0.5s; animation-name: fadeInRight;">
                    <h4>联系我们</h4>
                    <p style="padding-top: 10px">源创客 五号楼 六层</p>
                    <p>淮北市相山区濉溪路265号</p>
                    <p>联系电话: 0561-3199633</p>
                    <a href="mailto:794384313@qq.com" style="color: #333;">794384313@qq.com</a>
                </div>
                <div class="col-md-3 footer-grid wow fadeInUpBig animated animated" data-wow-delay=".5s"
                     style="visibility: visible; animation-delay: 0.5s; animation-name: fadeInUpBig;">
                    <h4>微信公众号</h4>
                    <img style="height: 120px;width: 120px;padding-top: 10px" src="/static/img/weixin.jpg">
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
    </div>


    <div class="gototop js-top">
        <a href="#" class="js-gotop"><i class="icon-arrow-up"></i></a>
    </div>

</div>

<!-- jQuery -->
<script src="/static/js/jquery.min.js"></script>
<!-- jQuery Easing -->
<script src="/static/js/jquery.easing.1.3.js"></script>
<!-- Bootstrap -->
<script src="/static/plug/bootstrap/js/bootstrap.min.js"></script>
<!-- Waypoints -->
<script src="/static/js/jquery.waypoints.min.js"></script>
<!-- Stellar Parallax -->
<script src="/static/js/jquery.stellar.min.js"></script>
<!-- Carousel -->
<script src="/static/js/owl.carousel.min.js"></script>
<!-- countTo -->
<script src="/static/js/jquery.countTo.js"></script>
<!-- Magnific Popup -->
<script src="/static/js/jquery.magnific-popup.min.js"></script>
<script src="/static/js/magnific-popup-options.js"></script>
<!-- Main -->
<script src="/static/js/main.js"></script>
<!-- layer-->
<script type="text/javascript" src="/static/laypage/1.2/laypage.js"></script>
<script type="text/javascript" src="/static/layer/2.4/layer.js"></script>
<script type="text/javascript" src="/static/js/amazeui.min.js"></script>
<script type="text/javascript" src="/static/js/1.14.0/jquery.validate.js"></script>
<script type="text/javascript" src="/static/js/1.14.0/validate-methods.js"></script>
<script type="text/javascript" src="/static/js/1.14.0/messages_zh.js"></script>

<script>

    $().ready(function () {
        // 在键盘按下并释放及提交后验证提交表单
        $("#signed").validate({
            rules: {
                phone: {
                    required: true,
                    isMobile: true
                    {#email:true#}
                },
                apartment: {
                    required: true
                },
                QQ: {
                    required: true,
                    number: true,
                    minlength: 5,
                    maxlength: 12

                },
                WX: {
                    required: true
                }
            }
        });
    });


    // 将所有的input框绑定获取焦点的事件，将所有的错误信息清空
    $("form input").focus(function () {
        $(this).next().html("");
    });


    $("#sub_name").click(function () {
        var user_name = $("[name='text']").val();
        var zt = $("#ziti option:selected").html();
        if (user_name == "") {
            layer.msg("您还未输入内容，不能生成，抱歉！");
        } else if (user_name.length > 4) {
            $("#my_sign_head").html("如果满意，请点击生成证书按钮，方便您生成编程一小时证书。");
            getImg(user_name, 26, zt);
        } else if (user_name.length < 6 && user_name.length > 2) {
            $("#my_sign_head").html("如果满意，请点击生成证书按钮，方便您生成编程一小时证书。");
            getImg(user_name, 80, zt);
        } else if (user_name.length == 2) {
            var user_name = user_name.replace(/(.{1})/g, '$1  ');
            $("#my_sign_head").html("如果满意，请点击生成证书按钮，方便您生成编程一小时证书。");
            getImg(user_name, 90, zt);
        }
        ;
    });


    var url = "";

    function getImg(text, fsz, zt) {
        if ($("#myCanvas").hasClass("hidden")) {
            $("#myCanvas").removeClass("hidden");
            $("#my_certificate_img").remove();
            var c = document.getElementById("myCanvas");
            var cxt = c.getContext("2d");
            var img = new Image();
            img.src = '/static/img/bg_for_sign.png';
            img.onload = function () {//图片加载完成，才可处理
                cxt.clearRect(0, 0, 300, 200);
                cxt.back
                cxt.drawImage(img, 0, 0, 300, 200, 0, 0, 300, 200);
                cxt.save();
                cxt.font = fsz + "px " + zt;
                cxt.textBaseline = 'middle';//更改字号后，必须重置对齐方式，否则居中麻烦。设置文本的垂直对齐方式
                cxt.textAlign = 'center';
                var tw = cxt.measureText(text).width;
                var ftop = c.height / 2;
                var fleft = c.width / 2;
                cxt.fillStyle = "rgba(225,225,225,0)";
                cxt.fillRect(fleft - tw / 2, ftop - fsz / 2, tw, fsz);//矩形在画布居中方式
                cxt.fillStyle = "black";
                cxt.fillText(text, fleft, ftop);//文本元素在画布居中方式
                url = c.toDataURL('image/png', 1.0);
            };
        } else {
            var c = document.getElementById("myCanvas");
            var cxt = c.getContext("2d");
            var img = new Image();
            img.src = '/static/img/bg_for_sign.png';
            img.onload = function () {//图片加载完成，才可处理
                cxt.clearRect(0, 0, 300, 200);
                cxt.drawImage(img, 0, 0, 300, 200, 0, 0, 300, 200);
                cxt.save();
                cxt.font = fsz + "px " + zt;
                cxt.textBaseline = 'middle';//更改字号后，必须重置对齐方式，否则居中麻烦。设置文本的垂直对齐方式
                cxt.textAlign = 'center';
                var tw = cxt.measureText(text).width;
                var ftop = c.height / 2;
                var fleft = c.width / 2;
                cxt.fillStyle = "rgba(225,225,225,0)";
                cxt.fillRect(fleft - tw / 2, ftop - fsz / 2, tw, fsz);//矩形在画布居中方式
                cxt.fillStyle = "black";
                cxt.fillText(text, fleft, ftop);//文本元素在画布居中方式
                //cxt.strokeStyle = 'yellow';
                //cxt.strokeText(text,fleft,ftop);//文字边框
                url = c.toDataURL('image/png', 1.0);
            };
        }
    };


    $("#sub_certificate").click(function () {
        var flag = $("#signed").valid();
        if (!flag) {
            return;
        } else {
            var user_name = $("[name='text']").val();
            var zt = $("#ziti option:selected").html();
            var phone = $("#phone").val();
            var apart = $("#apartment").val();
            var QQ = $("#QQ").val();
            var WX = $("#WX").val();
            if (url == "") {
                layer.msg("尚未生成签名，不能生成证书，请您先选择自己喜欢的字体生成签名！")
            } else {
                if ($("#my_certificate_img").length > 0) {
                    layer.msg("您已生成过证书，请勿重复生成，谢谢！")
                } else {
                    $.ajax({
                        url: '/save_sign_data/',
                        type: 'post',
                        data: {
                            name: user_name,
                            zt: zt,
                            phone: phone,
                            apartment: apart,
                            QQ: QQ,
                            WX: WX,
                            url: url,
                            csrfmiddlewaretoken: $("[name='csrfmiddlewaretoken']").val()
                        },
                        success: function (data) {
                            if (data.status == 1) {
                                $("#doc-modal-1").modal('close');
                                var img = "<img id='my_certificate_img' src='" + data.cer_url + "' style='width: 200px;height: 200px;'>";
                                $("#myCanvas").addClass("hidden");
                                $("#my_certificate").append(img);
                            } else {
                                layer.msg("出错了，暂未生成！")
                            }
                        }
                    })
                }
            }
        }
    });

    $("#view_certificate").click(function () {
        if ($("#my_certificate_img").length > 0) {
            var newWeb = window.open('_blank');
            newWeb.location = $("#my_certificate_img").attr("src");
        } else {
            layer.msg("尚未生成证书，不能查看，请先生成证书！")
        }
    });


    $("#down_certificate").click(function () {

        if ($("#my_certificate_img").length > 0) {
            img_url = $("#my_certificate_img").attr("src");
            $("#down_certificate").attr("href", img_url);
        } else {
            layer.msg("尚未生成证书，不能下载，请先生成证书！")
        }
    });

    function showSignImg(ths) {
        $("[na='cer_img']").attr("src", ths);
        console.log(ths);
    }

</script>


<script type="text/javascript">function arcSlip() {
    var oPic = document.getElementById('user_pic');
    var oPrev = getByClass(oPic, 'prev')[0];
    var oNext = getByClass(oPic, 'next')[0];

    var aLi = oPic.getElementsByTagName('li');

    var arr = [];

    for (var i = 0; i < aLi.length; i++) {
        var oImg = aLi[i].getElementsByTagName('img')[0];

        arr.push([parseInt(getStyle(aLi[i], 'left')), parseInt(getStyle(aLi[i], 'top')),
            getStyle(aLi[i], 'zIndex'), oImg.width, parseFloat(getStyle(aLi[i], 'opacity') * 100)]);
    }


    oPrev.onclick = function moveTP() {
        arr.push(arr[0]);
        arr.shift();
        for (var i = 0; i < aLi.length; i++) {
            var oImg = aLi[i].getElementsByTagName('img')[0];

            aLi[i].style.zIndex = arr[i][2];
            startMove(aLi[i], {left: arr[i][0], top: arr[i][1], opacity: arr[i][4]});
            startMove(oImg, {width: arr[i][3]});
        }

    }

    oNext.onclick = function moveTN() {
        arr.unshift(arr[arr.length - 1]);
        arr.pop();
        for (var i = 0; i < aLi.length; i++) {
            var oImg = aLi[i].getElementsByTagName('img')[0];

            aLi[i].style.zIndex = arr[i][2];
            startMove(aLi[i], {left: arr[i][0], top: arr[i][1], opacity: arr[i][4]});
            startMove(oImg, {width: arr[i][3]});
        }
    }
    var moveTime = setInterval(function () {

        oNext.click();

    }, 1000);
    $('#user_pic').hover(function () {
        ;
        ;
        clearInterval(moveTime);
    }, function () {
        moveTime = setInterval(function () {
            oNext.click();
        }, 1000);
    });

    function getStyle(obj, name) {
        if (obj.currentStyle) {
            return obj.currentStyle[name];
        }
        else {
            return getComputedStyle(obj, false)[name];
        }
    }
}

function getByClass(oParent, sClass) {
    var aResult = [];
    var aEle = oParent.getElementsByTagName('*');

    for (var i = 0; i < aEle.length; i++) {
        if (aEle[i].className == sClass) {
            aResult.push(aEle[i]);
        }
    }
    return aResult;
}

function getStyle(obj, name) {
    if (obj.currentStyle) {
        return obj.currentStyle[name];
    }

    else {
        return getComputedStyle(obj, false)[name];
    }
}

function startMove(obj, json, fnEnd) {
    clearInterval(obj.timer);
    obj.timer = setInterval(function () {
        var bStop = true;
        for (var attr in json) {
            var cur = 0;

            if (attr == 'opacity') {
                cur = Math.round(parseFloat(getStyle(obj, attr)) * 10);
            }
            else {
                cur = parseInt(getStyle(obj, attr));
            }

            var speed = (json[attr] - cur) / 6;
            speed = speed > 0 ? Math.ceil(speed) : Math.floor(speed);

            if (cur != json[attr]) bStop = false;

            if (attr == 'opacity') {
                obj.style.filter = 'alpha(opacity:' + (cur + speed) + ')';
                obj.style.opacity = (cur + speed) / 10;
            }
            else {
                obj.style[attr] = cur + speed + 'px';
            }
        }
        if (bStop) {
            clearInterval(obj.timer);
            if (fnEnd) fnEnd();
        }
    }, 30)

}

arcSlip();
</script>


</body>
</html>

